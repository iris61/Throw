{"version":3,"sources":["../../../../../../assets/script/modules/settings/assets/script/modules/settings/SettingComponent.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"../../../../../../assets/script/modules/settings","sourcesContent":["import SwitchControlComponent from \"./SwitchControlComponent\";\nimport { Constants } from \"../../Constants\";\nimport StorageUtils from \"../../utils/StorageUtils\";\nimport JSInterfaceUtils from \"../bridge/JSInterfaceUtils\";\n\nconst { ccclass, property } = cc._decorator;\n\n@ccclass\nexport default class SettingComponent extends cc.Component {\n\n    @property(cc.Label)\n    currencyLabel: cc.Label = null;\n\n    @property(cc.Button)\n    backButton: cc.Button = null;\n\n    @property(cc.AudioClip)\n    buttonClickAudio: cc.AudioClip = null;\n\n    @property(SwitchControlComponent)\n    soundsSwitchComponent: SwitchControlComponent = null;\n\n    @property(SwitchControlComponent)\n    vibrationSwitchComponent: SwitchControlComponent = null;\n\n    @property(SwitchControlComponent)\n    leftHandSwitchComponent: SwitchControlComponent = null;\n\n    onLoad() {\n        cc.log(\"SettingComponent onLoad()\")\n\n        this.currencyLabel.getComponent(cc.Label).string = StorageUtils.shared.getString(Constants.KEY_CURRENCY, \"0\");\n\n        this.initSwitchComponent(Constants.KEY_SOUND_SWITCH, this.soundsSwitchComponent);\n        this.initSwitchComponent(Constants.KEY_VIBRATION_SWITCH, this.vibrationSwitchComponent);\n        this.initSwitchComponent(Constants.KEY_LEFT_HAND_SWITCH, this.leftHandSwitchComponent);\n\n        this.backButton.node.on(cc.Node.EventType.TOUCH_END, () => {\n            if (StorageUtils.shared.getBoolean(Constants.KEY_SOUND_SWITCH, true)) {\n                cc.audioEngine.playEffect(this.backButton.getComponent(cc.AudioSource).clip, false);\n            }\n\n            this.node.removeFromParent();\n        }, this);\n\n        JSInterfaceUtils.logAnalyticsEvent(\"ThrowingMaster_Settings_Page_Viewed\");\n    }\n\n    start() {\n    }\n\n    update(dt) {\n    }\n\n    private initSwitchComponent(settingItemKey: string, switchComponent: SwitchControlComponent): void {\n        if (!StorageUtils.shared.getString(settingItemKey)) {\n            StorageUtils.shared.putBoolean(settingItemKey, settingItemKey != Constants.KEY_LEFT_HAND_SWITCH);\n        }\n\n        switchComponent.init(StorageUtils.shared.getBoolean(settingItemKey));\n        switchComponent.setSwitchStateChangeCallback((checked) => {\n            if (StorageUtils.shared.getBoolean(Constants.KEY_SOUND_SWITCH, true)) {\n                cc.audioEngine.playEffect(this.buttonClickAudio, false);\n            }\n\n            StorageUtils.shared.putBoolean(settingItemKey, checked);\n\n            switch (settingItemKey) {\n                case Constants.KEY_VIBRATION_SWITCH:\n                    JSInterfaceUtils.logAnalyticsEvent(\"ThrowingMaster_Settings_Vibration_Switch\", \"operation\", checked ? \"turn_on\" : \"turn_off\");\n                    break;\n\n                case Constants.KEY_SOUND_SWITCH:\n                    JSInterfaceUtils.logAnalyticsEvent(\"ThrowingMaster_Settings_Sounds_Switch\", \"operation\", checked ? \"turn_on\" : \"turn_off\");\n                    break;\n\n                case Constants.KEY_LEFT_HAND_SWITCH:\n                    JSInterfaceUtils.logAnalyticsEvent(\"ThrowingMaster_Settings_LeftHand_Switch\", \"operation\", checked ? \"turn_on\" : \"turn_off\");\n                    break;\n            }\n        });\n    }\n}\n"]}