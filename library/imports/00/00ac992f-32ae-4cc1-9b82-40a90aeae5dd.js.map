{"version":3,"sources":["../../../../../../assets/script/modules/done/assets/script/modules/done/ContinueComponent.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"../../../../../../assets/script/modules/done","sourcesContent":["import StageProgressBarComponent from \"../../components/StageProgressBarComponent\";\nimport AppComponent from \"../../AppComponent\";\nimport StorageUtils from \"../../utils/StorageUtils\";\nimport { Constants } from \"../../Constants\";\nimport JSInterfaceUtils from \"../bridge/JSInterfaceUtils\";\n\nconst { ccclass, property } = cc._decorator;\n\n@ccclass\nexport default class ContinueComponent extends cc.Component {\n\n    @property(cc.Node)\n    stageProgressBarLayoutNode: cc.Node = null;\n\n    @property(cc.Node)\n    circleAnimationNode: cc.Node = null;\n\n    @property(cc.Label)\n    stageLabel: cc.Label = null;\n\n    @property(cc.Label)\n    scoreLabel: cc.Label = null;\n\n    @property(cc.Label)\n    topScoreLabel: cc.Label = null;\n\n    @property(cc.Label)\n    currencyLabel: cc.Label = null;\n\n    @property(cc.Button)\n    quitButton: cc.Button = null;\n\n    @property(cc.Button)\n    continueButton: cc.Button = null;\n\n    @property(cc.AudioClip)\n    countdownAudio: cc.AudioClip = null;\n\n    private static instance: ContinueComponent = null;\n\n    private appNode: cc.Node = null;\n\n    private stageTitle: string;\n\n    private stage: number = 1;\n    private score: number = 0;\n\n    private watchingAd: boolean = false;\n    private continueGame: boolean = false;\n\n    onLoad() {\n        this.currencyLabel.getComponent(cc.Label).string = StorageUtils.shared.getString(Constants.KEY_CURRENCY, \"0\");\n        this.stageProgressBarLayoutNode.getComponent(StageProgressBarComponent).init(this.stage);\n\n        this.stageTitle = Constants.PREFIX_STAGE_TITLE + this.stage;\n        this.stageLabel.string = this.stageTitle;\n\n        this.scoreLabel.string = String(this.score);\n        this.topScoreLabel.string = String(this.score);\n\n        this.scheduleOnce(function () {\n            this.quitButton.node.on(cc.Node.EventType.TOUCH_END, () => {\n                cc.audioEngine.stopAllEffects();\n                if (StorageUtils.shared.getBoolean(Constants.KEY_SOUND_SWITCH, true)) {\n                    cc.audioEngine.playEffect(this.quitButton.getComponent(cc.AudioSource).clip, false);\n                }\n\n                this.appNode.getComponent(AppComponent).jumpToDonePage(this.stage, this.score);\n\n                JSInterfaceUtils.logAnalyticsEvent(\"ThrowingMaster_Continue_Page_Clicked\", \"operation\", \"no_thanks\");\n            }, this);\n\n            this.quitButton.node.opacity = 110;\n        }, 2);\n\n        this.continueButton.node.on(cc.Node.EventType.TOUCH_END, () => {\n            cc.audioEngine.stopAllEffects();\n            if (StorageUtils.shared.getBoolean(Constants.KEY_SOUND_SWITCH, true)) {\n                cc.audioEngine.playEffect(this.continueButton.getComponent(cc.AudioSource).clip, false);\n            }\n\n            JSInterfaceUtils.watchRewardAd(Constants.POSTION_CONTINUE, Constants.WATCH_AD_FOR_CONTINUE_GAME);\n            this.watchingAd = true;\n\n            JSInterfaceUtils.logAnalyticsEvent(\"ThrowingMaster_Continue_Page_Clicked\", \"operation\", \"continue\");\n            JSInterfaceUtils.logAutopilotEvent(\"continue_button_click\");\n        }, this);\n\n        this.circleAnimationNode.getComponent(cc.Animation).on(Constants.EVENT_ANIMATION_STOP, () => {\n            this.appNode.getComponent(AppComponent).jumpToDonePage(this.stage, this.score);\n            cc.audioEngine.stopAllEffects();\n        });\n\n        this.circleAnimationNode.getComponent(cc.Animation).play();\n        if (StorageUtils.shared.getBoolean(Constants.KEY_SOUND_SWITCH, true)) {\n            cc.audioEngine.playEffect(this.countdownAudio, false);\n        }\n\n        JSInterfaceUtils.logAnalyticsEvent(\"ThrowingMaster_Continue_Page_Viewed\");\n    }\n\n    public init(stage: number, score: number, appNode: cc.Node): void {\n        ContinueComponent.instance = this;\n\n        this.stage = stage;\n        this.stageTitle = Constants.PREFIX_STAGE_TITLE + stage;\n\n        this.score = score;\n        this.appNode = appNode;\n    }\n\n    public static watchAdForContinueGame(): void {\n        ContinueComponent.instance.appNode.getComponent(AppComponent).continuePlay();\n        ContinueComponent.instance.continueGame = true;\n    }\n\n    public static isWatchingAd(): boolean {\n        return ContinueComponent.instance && ContinueComponent.instance.watchingAd;\n    }\n\n    public static closeAd(): void {\n        ContinueComponent.instance.watchingAd = false;\n    }\n\n    public static getContinueGame(): boolean {\n        return ContinueComponent.instance.continueGame;\n    }\n}\n"]}