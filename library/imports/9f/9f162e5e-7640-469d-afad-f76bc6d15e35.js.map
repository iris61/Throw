{"version":3,"sources":["../../../../../assets/script/components/assets/script/components/FallingControlComponent.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"../../../../../assets/script/components","sourcesContent":["const { ccclass, property } = cc._decorator;\n\nexport const enum Direction {\n    LEFT = 1,\n    RIGHT = 0,\n}\n\n@ccclass\nexport default class FallingControlComponent extends cc.Component {\n\n    @property(cc.Prefab)\n    prefab: cc.Prefab = null;\n\n    @property(Number)\n    verticalAccelerate: Number = 3000;\n\n    @property(Number)\n    horizentalAccelerate: Number = 0;\n\n    private lastPos: cc.Vec2 = new cc.Vec2(0, 0);\n\n    private speed: number = 800;\n    private speedAngle: number = 0;\n    private direction: number = Direction.RIGHT;\n\n    onLoad() {\n        cc.log(\"FallingControlComponent onLoad\");\n    }\n\n    start() {\n    }\n\n    update(dt) {\n\n        if (!this.node) {\n            return;\n        }\n\n        let newPos: cc.Vec2 = new cc.Vec2(0, 0);\n\n        newPos.x = this.speed * Math.cos(this.speedAngle / 360 * 2 * Math.PI) * dt + this.lastPos.x;\n        newPos.y = this.speed * Math.sin(this.speedAngle / 360 * 2 * Math.PI) * dt + this.lastPos.y;\n\n        this.node.setPosition(newPos);\n\n        this.lastPos = newPos;\n\n        this.speedAngle = Math.atan((this.speed * Math.sin(this.speedAngle / 360 * 2 * Math.PI) - Number(this.verticalAccelerate) * dt)\n            / (this.speed * Math.cos(this.speedAngle / 360 * 2 * Math.PI) + Number(this.horizentalAccelerate) * dt)) / 2 / Math.PI * 360 + this.direction * 180;\n\n        this.speed = Math.sqrt((this.speed * Math.cos(this.speedAngle / 360 * 2 * Math.PI) + Number(this.horizentalAccelerate) * dt) *\n            (this.speed * Math.cos(this.speedAngle / 360 * 2 * Math.PI) + Number(this.horizentalAccelerate) * dt) +\n            (this.speed * Math.sin(this.speedAngle / 360 * 2 * Math.PI) - Number(this.verticalAccelerate) * dt) *\n            (this.speed * Math.sin(this.speedAngle / 360 * 2 * Math.PI) - Number(this.verticalAccelerate) * dt));\n    }\n\n    public split(speedAngle: number, direction: number): void {\n        this.speedAngle = speedAngle;\n        this.direction = direction;\n        this.speed = 800;\n        this.lastPos = new cc.Vec2(0, 0);\n\n        if (this.node.childrenCount == 0) {\n            let partNode: cc.Node = cc.instantiate(this.prefab);\n            this.node.addChild(partNode);\n        }\n    }\n}\n"]}